# 寻路算法
寻路算法主要分为两种盲目式和启发式。盲目式不使用关于目标位置的任何信息来指导搜索过程。它不考虑目标在哪里，只是系统地搜索图的每个部分，直到找到目标为止。常见的盲目式搜索算法有DFS和BFS。启发式搜索使用关于目标位置的信息来指导搜索过程。它通过估计从当前节点到目标节点的距离来选择下一步探索的节点，从而试图减少搜索空间。**寻路算法有很多，各种改进方向几乎也是为了适合某个特定场景或者有特殊需求，使用时根据自己的使用需求，合理选择寻路算法**
## 盲目式
### 广度优先搜索（BFS）与深度优先搜索（DFS）
- **原理**：暴力遍历地图节点，BFS保证最短路径但效率低，DFS可能陷入局部最优。
- **游戏应用**：适用于小型网格地图原型验证，如回合制策略游戏的简单AI。
### Dijkstra算法
- **原理**：通过优先级队列寻找起点到所有节点的最短路径，时间复杂度O((V+E)logV)。
- **优化技巧**：二叉堆优先队列、提前终止（当目标节点弹出时停止）。
- **适用场景**：均匀移动成本的策略游戏（如《文明》系列）。
## 启发式
### A*
#### 基本原理
A算法的核心思想是结合了Dijkstra算法和Best-First-Search算法的特点。它使用一个估价函数 f(n) = g(n) + h(n) 来估算从起始点到目标点的总代价，其中 g(n) 表示从起始点到当前节点的代价， h(n) 是从当前节点到目标点的启发式估计代价。A算法通过扩展路径代价最小的节点来寻找目标点，它保证了如果 h(n) 的估计值是准确的，那么找到的路径也是最短的。**启发式函数 h(n) 的选择对算法的性能有很大影响**。常见的启发式函数包括欧几里得距离，曼哈顿距离等。
算法流程
A*算法的主要流程如下：
1. 初始化开放列表（Open List）和关闭列表（Closed List）。
2. 将起始节点加入开放列表，并设置起始节点的 g 值为0。
3. 当开放列表不为空时，执行以下步骤：
  - 从开放列表中选择 f 值最小的节点作为当前节点。
  - 如果当前节点是目标节点，则算法结束，路径找到。
  - 将当前节点从开放列表移除，并加入关闭列表。
  - 对当前节点的每个邻居节点进行处理：
    - 如果邻居节点不可到达或者已经在关闭列表中，则忽略它。
    - 否则，计算邻居节点的 g 值和 f 值，并更新其在开放列表中的记录。
4. 如果开放列表为空且目标节点不在开放列表中，则算法失败，没有找到路径
#### 游戏开发实践
- **数据结构优化**：使用双二叉堆（Open/Close列表）或跳跃点优化网格搜索。
- **动态权重**：调整启发式权重实现速度与精度的平衡（如f(n) = g(n) + w * h(n)）。
#### 变体算法
- **IDA\***：迭代加深的A*，适用于内存受限场景。(A∗是对于bfs的优化，启发式搜索IDA∗是对于dfs的优化，是基于迭代加深的A∗算法)
- **Theta\***：基于网格的任意角度寻路,支持任意角度移动的路径平滑优化。
### B*

### JPS(跳点搜索)

## 高级算法与工程化优化
#### 分层寻路（Hierarchical Pathfinding）
- 核心思想：将地图抽象为高层区域（如房间、走廊），先规划区域路径再细化局部路径。
- 算法代表：HPA*（Hierarchical Pathfinding A*）。
- 应用案例：开放世界游戏（如《GTA5》）的大规模地图导航。
#### 导航网格（NavMesh）
- 原理：将可行走区域划分为凸多边形网格，通过三角形/多边形中心点寻路。
- 优势：天然支持复杂地形与3D空间（如《王者荣耀》的野区移动）。路径平滑度高，无需后处理。
- 生成工具：Recast Navigation（开源库，被Unity/Unreal集成）。
#### 动态环境响应算法
- LPA（Lifelong Planning A）**：增量式更新路径，适用于动态障碍物（如《星际争霸》中建筑物被摧毁后的实时重规划）。
- D Lite*：优化版本，被广泛用于机器人导航和RTS游戏。
#### 群体寻路（Crowd Simulation）
- 流场算法（Flow Field）：预计算每个网格的移动方向向量，支持大规模单位高效移动（如《全面战争》系列）。
- RVO（Reciprocal Velocity Obstacle）：基于速度障碍物的避障模型，实现自然群体运动。
## 性能优化与工程实践
- 数据结构优化
  - 优先队列：Fibonacci堆优化A*的Open列表操作。
  - 空间分区：四叉树/网格空间索引加速邻居节点查询。
- 预处理技术
  - 路点图（Waypoint Graph）：人工标记关键路径点，降低运行时计算量。
  - Jump Point Search：跳过对称路径，加速网格寻路（适合2D方格地图）。
- 多线程与异步计算
  - 分帧计算：将长路径分解为多帧处理，避免卡顿。
  - Job System：利用Unity DOTS或Unreal的异步任务系统并行寻路。
## 算法选型指南
游戏类型    推荐算法    理由
2D策略游戏（如《文明》） A* + 导航网格   平衡效率与精度
3DMMORPG（如《魔兽世界》）  NavMesh + 分层寻路  处理复杂地形，支持数千NPC
RTS（如《星际争霸》）	流场算法 + D* Lite	大规模单位实时响应动态环境
移动端休闲游戏	预计算路点 + BFS	低计算开销，适配硬件限制
